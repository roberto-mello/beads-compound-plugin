# Generated by beads-compound v0.6.0
# DO NOT EDIT - changes will be overwritten on next install

description = "Have multiple specialized agents review a plan in parallel"

prompt = """

# Plan Review

Review an epic plan using multiple specialized agents in parallel to catch issues before implementation begins.

## Epic Bead

<epic_bead_id> #{{args}} </epic_bead_id>

**If the epic bead ID above is empty:**
1. Check for recent epic beads: `bd list --type epic --status=open --json`
2. Ask the user: "Which epic plan would you like reviewed? Please provide the bead ID (e.g., `BD-001`)."

Do not proceed until you have a valid epic bead ID.

## Step 1: Load the Plan

```bash
# Read the epic
bd show {EPIC_ID}

# List and read all child beads
bd list --parent {EPIC_ID} --json
```

For each child bead, read its full description:

```bash
bd show {CHILD_ID}
```

Assemble the full plan content from epic description + all child bead descriptions.

## Step 2: Recall Relevant Knowledge

```bash
# Search for knowledge related to the plan's topic
.beads/memory/recall.sh "{keywords from epic title}"
.beads/memory/recall.sh "{tech stack keywords}"
```

Include any relevant LEARNED/DECISION/FACT/PATTERN entries as context for reviewers.

## Step 3: Dispatch Review Agents in Parallel

Run these 4 agents simultaneously, passing the full plan content to each:

1. Task architecture-strategist("Review this plan for architectural soundness, scalability, and maintainability. Plan: [full plan content]")
2. Task code-simplicity-reviewer("Review this plan for unnecessary complexity, over-engineering, and opportunities to simplify. Plan: [full plan content]")
3. Task security-sentinel("Review this plan for security vulnerabilities, missing auth checks, data exposure risks. Plan: [full plan content]")
4. Task performance-oracle("Review this plan for performance bottlenecks, N+1 queries, missing caching, scalability issues. Plan: [full plan content]")

## Step 4: Synthesize Findings

After all agents complete, synthesize their feedback into a categorized report:

```markdown
## Plan Review: {EPIC_ID} - {epic title}

### Architecture
[Findings from architecture-strategist]
- Strengths: [what's well designed]
- Concerns: [architectural issues]
- Suggestions: [improvements]

### Simplicity
[Findings from code-simplicity-reviewer]
- Over-engineering risks: [what could be simpler]
- Unnecessary abstractions: [what to remove]
- Suggestions: [simplifications]

### Security
[Findings from security-sentinel]
- Vulnerabilities: [security risks found]
- Missing protections: [what needs adding]
- Suggestions: [security improvements]

### Performance
[Findings from performance-oracle]
- Bottlenecks: [performance concerns]
- Missing optimizations: [what to add]
- Suggestions: [performance improvements]

### Summary
- **Critical issues:** [count] - Must fix before implementing
- **Important suggestions:** [count] - Should consider
- **Minor improvements:** [count] - Nice to have

### Recommended Changes
1. [Most impactful change]
2. [Second most impactful]
3. [Third most impactful]
```

## Step 5: Log Key Findings

For significant findings, log knowledge:

```bash
bd comments add {EPIC_ID} "LEARNED: Plan review found: {key insight}"
```

## Post-Review Options

After presenting the review, use the **AskUserQuestion tool** to present these options:

**Question:** "Plan review complete for `{EPIC_ID}`. What would you like to do next?"

**Options:**
1. **Apply feedback** - Update child beads with review suggestions
2. **Run `/beads-deepen`** - Enhance plan with additional research
3. **Start `/beads-work`** - Begin implementing (accept plan as-is)
4. **Dismiss** - Acknowledge review without changes

"""
